Script is created to backup KVM virtual machines with libvirt.

By design, it greps all VM's disk files (targets), making snapshots for their state to ensure, no file transactions will be lost. 
It copies snapshot disk file to backup folder and then merges snapshots. Also it has a cleaning mechanism for old backups.


Log file for script is /var/log/kvm.backup-domains.log.


Script is getting following parameters:
	-n	-	Name of VM/Domain to backup. If not provided - script will backup all VMs on this server.

	-c	-	Count of backups to store. If not provided - script is using 6 copies by default. 
			Script sorting backup folder by name and removing the oldest.

	-p	-	Path to backup folder. If not provided - will use default path "/datastore/backup". 
			It should be the root folder for backups. Script will create sub-folders for each VM and date of copie.


Examples:
	$ sudo bash kvm.backup-domains.bash -n "vm-name" -c 4 -p /datastore/backup   # Backup 'vm-name' VM, keep '4' copies, backup to '/datastore/backup' folder.
	$ sudo bash kvm.backup-domains.bash -n "vm-name" -c 4   # Backup 'vm-name' VM, keep '4' copies.
	$ sudo bash kvm.backup-domains.bash -c 4   # Backup ALL VMs on server, keep '4' copies, use default path to backups.

ATTENTION!
By default there is a function for mounting NFS share, where backups will be stored. Variables in the beggining of script, contains which server and path to mount, and where to mount.
	NETNFS_PATH="123.123.123.123:/var/nfs/general"
	MOUNT_PATH="/datastore"
To disable this, comment following lines:
	...
	mount_nfs   # Comment if NFS mount is not required
	...
	...
	echo "Unmounting mount path" >> $LOG_PATH
	umount $MOUNT_PATH   # Comment if NFS path is not used
	...
